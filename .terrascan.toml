# Terrascan Configuration
# Documentation: https://runterrascan.io/docs/usage/config_options/

[terrascan]
# Only scan the terraform directory (avoid scanning docs, python, etc.)
scan-rules = ["terraform"]

# Policy configuration
[policy]
# Use AWS policies
path = []
rego_subdir = ""

# Severity levels to fail on (high, medium, low)
severity = "high"

# Skip specific rules (false positives only - document each)
# Security groups now use security group references instead of CIDR blocks
skip-rules = [
    # AC_AWS_0369: False positive - VPC flow logs ARE enabled via aws_flow_log.vpc_flow_logs
    # resource which is correctly connected to aws_vpc.main[0].id. Terrascan doesn't detect
    # cross-resource relationships. See terraform/aws.tf lines 27-38.
    "AC_AWS_0369",
]

# Notification configuration
[notifications]
# Webhook URL for notifications (optional)
webhook-url = ""
webhook-token = ""

# Output configuration
[output]
# Output format: json, yaml, xml, junit-xml, sarif, github-sarif
format = "json"
